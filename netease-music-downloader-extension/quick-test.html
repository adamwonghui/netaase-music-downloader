<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>快速测试修复效果</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
        }
        .header {
            background: linear-gradient(135deg, #28a745, #20c997);
            color: white;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            text-align: center;
        }
        .section {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        .success {
            background: #d4edda;
            color: #155724;
            padding: 15px;
            border-radius: 6px;
            border-left: 4px solid #28a745;
            margin: 10px 0;
        }
        .info {
            background: #e3f2fd;
            color: #1565c0;
            padding: 15px;
            border-radius: 6px;
            border-left: 4px solid #2196f3;
            margin: 10px 0;
        }
        .code {
            background: #2d3748;
            color: #e2e8f0;
            padding: 15px;
            border-radius: 6px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            margin: 10px 0;
        }
        button {
            background: linear-gradient(135deg, #28a745, #20c997);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            margin: 5px;
            font-size: 16px;
        }
        button:hover {
            background: linear-gradient(135deg, #20c997, #28a745);
        }
        .test-link {
            display: inline-block;
            background: linear-gradient(135deg, #ff6b6b, #ee5a24);
            color: white;
            padding: 12px 24px;
            text-decoration: none;
            border-radius: 6px;
            margin: 10px 5px;
            transition: all 0.3s ease;
        }
        .test-link:hover {
            background: linear-gradient(135deg, #ff5252, #d63031);
            transform: translateY(-2px);
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>🎉 问题已修复！</h1>
        <p>插件歌曲信息提取功能已优化</p>
    </div>

    <div class="section">
        <h2>🔧 修复内容</h2>
        <div class="success">
            <h3>已解决的问题：</h3>
            <ul>
                <li>✅ 修复了歌曲信息提取逻辑</li>
                <li>✅ 简化了标题解析过程</li>
                <li>✅ 修复了文件名生成错误</li>
                <li>✅ 增加了详细的调试日志</li>
            </ul>
        </div>
    </div>

    <div class="section">
        <h2>🧪 测试步骤</h2>
        <div class="info">
            <h3>请按以下步骤测试修复效果：</h3>
            <ol>
                <li><strong>重新加载插件</strong>：
                    <ul>
                        <li>访问 chrome://extensions/</li>
                        <li>找到"网易云音乐下载器"插件</li>
                        <li>点击刷新按钮 🔄</li>
                    </ul>
                </li>
                <li><strong>测试歌曲页面</strong>：
                    <ul>
                        <li>点击下面的测试链接</li>
                        <li>等待页面加载完成</li>
                        <li>点击下载按钮</li>
                    </ul>
                </li>
                <li><strong>验证结果</strong>：
                    <ul>
                        <li>检查下载的文件名</li>
                        <li>确认包含正确的歌曲信息</li>
                    </ul>
                </li>
            </ol>
        </div>
    </div>

    <div class="section">
        <h2>🎵 测试链接</h2>
        <p>点击下面的链接测试修复效果：</p>
        
        <a href="https://music.163.com/#/song?id=26386494" class="test-link" target="_blank">
            🎵 Touch (Touch) - 岩崎良美
        </a>
        
        <a href="https://music.163.com/#/song?id=34324255" class="test-link" target="_blank">
            🎌 風のメッセージ
        </a>
        
        <a href="https://music.163.com/#/song?id=1868553" class="test-link" target="_blank">
            🎵 Shape of You - Ed Sheeran
        </a>
    </div>

    <div class="section">
        <h2>🔍 测试验证代码</h2>
        <p>在歌曲页面控制台中执行以下代码验证修复效果：</p>
        
        <button onclick="copyTestCode()">📋 复制测试代码</button>
        
        <div class="code" id="testCode">// 测试修复后的歌曲信息提取
console.log('🧪 测试修复后的功能...');

// 测试标题提取
const title = document.title;
console.log('页面标题:', title);

if (title.includes(' - ')) {
    const parts = title.split(' - ');
    console.log('分割结果:', parts);
    
    const songName = parts[0].trim();
    const artistName = parts[1].trim();
    
    console.log('✅ 提取结果:');
    console.log('  歌曲名:', songName);
    console.log('  艺术家:', artistName);
    
    // 生成文件名
    let filename = '';
    if (songName && artistName && songName !== '网易云音乐' && artistName !== '网易云音乐') {
        filename = `${artistName} - ${songName}.mp3`;
    } else if (songName && songName !== '网易云音乐') {
        filename = `${songName}.mp3`;
    } else {
        filename = 'song_unknown.mp3';
    }
    
    console.log('生成的文件名:', filename);
} else {
    console.log('❌ 标题格式不正确');
}

// 测试下载按钮
const downloadBtn = document.querySelector('.netease-download-btn');
if (downloadBtn) {
    console.log('✅ 找到下载按钮');
    console.log('按钮文本:', downloadBtn.textContent.trim());
} else {
    console.log('❌ 未找到下载按钮');
}</div>
    </div>

    <div class="section">
        <h2>🎯 预期结果</h2>
        <div class="success">
            <h3>修复后应该看到：</h3>
            <ul>
                <li>✅ 控制台显示正确的歌曲名和艺术家</li>
                <li>✅ 生成的文件名包含歌曲信息</li>
                <li>✅ 下载的文件名不再是"网易云音乐"</li>
                <li>✅ 文件名格式：艺术家 - 歌曲名.mp3</li>
            </ul>
        </div>
        
        <div class="info">
            <h3>示例：</h3>
            <p><strong>Touch (Touch)歌曲</strong></p>
            <ul>
                <li>歌曲名：Touch (Touch)（TV动画《棒球英豪》OP1 / TVアニメ「タッチ」OP1テーマ）</li>
                <li>艺术家：岩崎良美</li>
                <li>文件名：岩崎良美 - Touch (Touch)（TV动画《棒球英豪》OP1 / TVアニメ「タッチ」OP1テーマ）.mp3</li>
            </ul>
        </div>
    </div>

    <script>
        function copyTestCode() {
            const codeElement = document.getElementById('testCode');
            const text = codeElement.textContent;
            
            navigator.clipboard.writeText(text).then(function() {
                alert('测试代码已复制到剪贴板！\n\n请在网易云音乐歌曲页面的控制台中粘贴并执行。');
            }).catch(function(err) {
                console.error('复制失败:', err);
                alert('复制失败，请手动选择代码并复制。');
            });
        }
        
        // 页面加载完成
        window.onload = function() {
            console.log('快速测试页面已加载');
            console.log('插件修复已完成，请重新加载插件并测试');
        };
    </script>
</body>
</html>
